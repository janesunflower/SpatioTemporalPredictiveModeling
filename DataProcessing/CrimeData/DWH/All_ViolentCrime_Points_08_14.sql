DROP TABLE X_All_Violent_Pts_08_14;

CREATE TABLE X_All_Violent_Pts_08_14
(
DATEOCC DATE, 
YEAR VARCHAR2(4),
MONTH VARCHAR2(2),
DAY VARCHAR2(2),
CURR_IUCR VARCHAR2(8),
FBI_CD VARCHAR2(3),
AREA VARCHAR2(1),
BEAT VARCHAR2(4),
DISTRICT VARCHAR2(2),
X_COORD VARCHAR2(8),
Y_COORD VARCHAR2(8),
LOCATION VARCHAR2(8),
INC_CNT NUMBER(1)
);

INSERT INTO X_All_Violent_Pts_08_14(DATEOCC,YEAR,MONTH,DAY,CURR_IUCR,FBI_CD,AREA,BEAT,DISTRICT,X_COORD,Y_COORD,LOCATION,INC_CNT)
SELECT DATEOCC, YEAR, MONTH, DAY, CURR_IUCR, FBI_CD, AREA, BEAT, DISTRICT, X_COORD, Y_COORD, LOCATION, INC_CNT
FROM CHRIS_DWH.CRIMES_POINTS_ALLV
WHERE (DATEOCC BETWEEN TO_DATE('2008/01/01 12:00:00AM', 'yyyy/mm/dd hh:mi:ssam') AND TO_DATE('2014/12/31 11:59:59PM', 'yyyy/mm/dd:hh:mi:ssam'))  
AND (CITY='CHICAGO') 
AND (CURR_IUCR IN ('0110','0130','041A','041B','0420','0430','0440','0479','051A','051B','0520','0530','0545','0560','1753','1754') 
OR CURR_IUCR LIKE '02__'
OR CURR_IUCR LIKE '03__'
OR CURR_IUCR LIKE '045_'
OR CURR_IUCR LIKE '046_'
OR CURR_IUCR LIKE '048_'
OR CURR_IUCR LIKE '049_'
OR CURR_IUCR LIKE '055_')
ORDER BY DATEOCC ASC;







